{"version":3,"names":["queryParams","common_vendor","ref","pageNum","pageSize","keyword","historySearch","index","getStorageSync","recommendList","noData","noSearch","classList","onSearch","showLoading","value","_toConsumableArray2","Set","concat","slice","setStorageSync","initParams","searchData","__f__","onClear","clickTab","removeHistory","showModal","title","success","res","confirm","removeStorageSync","_ref","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","wrap","_callee$","_context","prev","next","apiSearchData","sent","data","length","hideLoading","finish","stop","apply","arguments","undefined","onReachBottom","onUnload","wx","createPage","MiniProgramPage"],"sources":["search.vue","F:/HBuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VhcmNoL3NlYXJjaC52dWU"],"sourcesContent":["<template>\n\t<view class=\"searchLayout\">\n\t\t<view class=\"search\">\n\t\t\t<uni-search-bar \n\t\t\t@confirm=\"onSearch\"\n\t\t\t@cancel=\"onClear\"\n\t\t\t@clear=\"onClear\"\n\t\t\tfocus \n\t\t\tplaceholder=\"搜索\"\n\t\t\tv-model=\"queryParams.keyword\">\n\t\t\t</uni-search-bar>\n\t\t</view>\n\t\t\n\t\t\n\t\t<view v-if=\"!classList.length || noSearch\">\n\t\t\t<view class=\"history\"  v-if=\"historySearch.length\">\n\t\t\t\t<view class=\"topTitle\">\n\t\t\t\t\t<view class=\"text\">最近搜索</view>\n\t\t\t\t\t<view class=\"icon\" @click=\"removeHistory\">\n\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"25\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"tabs\">\n\t\t\t\t\t<view class=\"tab\" v-for=\"tab in historySearch\" :key=\"tab\" \n\t\t\t\t\t@click=\"clickTab(tab)\">{{tab}}</view>\t\t\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"recommend\">\n\t\t\t\t<view class=\"topTitle\">\n\t\t\t\t\t<view class=\"text\">热门搜索</view>\t\t\t\t\n\t\t\t\t</view>\n\t\t\t\t<view class=\"tabs\">\t\t\t\t\n\t\t\t\t\t<view class=\"tab\" v-for=\"tab in recommendList\" :key=\"tab\" \n\t\t\t\t\t@click=\"clickTab(tab)\">{{tab}}</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t\n\t\t<view class=\"noSearch\" v-if=\"noSearch\">\n\t\t\t<uv-empty mode=\"search\" icon=\"http://cdn.uviewui.com/uview/empty/search.png\"></uv-empty>\n\t\t</view>\n\t\t\n\t\t\n\t\t<view v-else>\n\t\t\t<view class=\"list\">\n\t\t\t\t<navigator :url=\"`/pages/preview/preview?id=${item._id}`\"  class=\"item\" \n\t\t\t\tv-for=\"item in classList\" :key=\"item._id\">\t\t\t\t\n\t\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\"></image>\t\t\t\t\n\t\t\t\t</navigator>\n\t\t\t</view>\t\t\n\t\t\t<view class=\"loadingLayout\" v-if=\"noData || classList.length\">\n\t\t\t\t<uni-load-more :status=\"noData?'noMore':'loading'\"/>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t\n\t</view>\n</template>\n\n<script setup>\nimport {ref} from \"vue\";\nimport {onLoad,onUnload,onReachBottom} from \"@dcloudio/uni-app\";\n// import {apiSearchData} from \"@/api/apis.js\"\n//查询参数\nconst queryParams = ref({\t\n\tpageNum:1,\n\tpageSize:12,\n\tkeyword:\"\"\n})\n\n//搜索历史词\nconst historySearch = ref(uni.getStorageSync(\"historySearch\") || []);\n\n//热门搜索词\nconst recommendList = ref([\"美女\",\"帅哥\",\"宠物\",\"卡通\"]);\n\n//没有更多\nconst noData = ref(false);\n//没有搜索结果\nconst noSearch = ref(false);\n\n//搜索结果列表\nconst classList = ref([]);\n\n\n//点击搜索\nconst onSearch = ()=>{\t\n\tuni.showLoading()\n\thistorySearch.value = \n\t[...new Set([queryParams.value.keyword,...historySearch.value])].slice(0,10);\n\t\n\tuni.setStorageSync(\"historySearch\",historySearch.value);\n\tinitParams(queryParams.value.keyword);\n\tsearchData();\n\tconsole.log(queryParams.value.keyword);\n}\n\n//点击清除按钮\nconst onClear = ()=>{\n\tinitParams();\n}\n\n\n\n//点击标签进行搜索\nconst clickTab = (value)=>{\n\tinitParams(value);\n\t\n\tonSearch();\n}\n\n\n//点击清空搜索记录\nconst removeHistory = ()=>{\n\tuni.showModal({\n\t\ttitle:\"是否清空历史搜索？\",\n\t\tsuccess:res=>{\n\t\t\tif(res.confirm){\n\t\t\t\tuni.removeStorageSync(\"historySearch\");\n\t\t\t\thistorySearch.value = []\n\t\t\t}\n\t\t}\n\t})\n}\n\nconst searchData = async ()=>{\n\ttry{\n\t\tlet res =  await apiSearchData(queryParams.value);\n\t\tclassList.value  =  [...classList.value,...res.data] ;\n\t\tuni.setStorageSync(\"storgClassList\",classList.value);\t\n\t\tif(queryParams.value.pageSize > res.data.length) noData.value = true;\n\t\tif(res.data.length == 0 && classList.value.length==0) noSearch.value = true;\n\t\tconsole.log(res);\n\t}finally{\n\t\tuni.hideLoading()\n\t}\n\t\n}\n\nconst initParams = (value='')=>{\n\tclassList.value = [];\n\tnoData.value = false;\n\tnoSearch.value = false;\n\tqueryParams.value = {\n\t\tpageNum:1,\n\t\tpageSize:12,\n\t\tkeyword:value || \"\"\n\t}\n}\n\n\n//触底加载更多\nonReachBottom(()=>{\n\tif(noData.value) return;\n\tqueryParams.value.pageNum++\n\tsearchData();\n})\n\n//关闭有页面\nonUnload(()=>{\n\tuni.removeStorageSync(\"storgClassList\",classList.value);\t\n})\n\n\n</script>\n\n<style lang=\"scss\" scoped>\n.searchLayout{\n\t.search{\n\t\tpadding:0 10rpx;\n\t}\n\t.topTitle{\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tfont-size: 32rpx;\n\t\tcolor:#999;\n\t}\n\t.history{\n\t\tpadding:30rpx;\t\t\n\t}\n\t.recommend{\n\t\tpadding:30rpx;\n\t}\n\t.tabs{\n\t\tdisplay: flex;\t\t\n\t\talign-items: center;\n\t\tflex-wrap: wrap;\n\t\tpadding-top:20rpx;\n\t\t.tab{\n\t\t\tbackground: #F4F4F4;\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor:#333;\n\t\t\tpadding:10rpx 28rpx;\n\t\t\tborder-radius: 50rpx;\n\t\t\tmargin-right: 20rpx;\n\t\t\tmargin-top: 20rpx;\n\t\t}\n\t}\t\n\t.list{\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(3,1fr);\n\t\tgap: 5rpx;\n\t\tpadding:20rpx 5rpx;\t\t\n\t\t.item{\n\t\t\theight: 440rpx;\n\t\t\timage{\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\t\t\t\n\t\t}\t\t\n\t}\n}\n</style>\n","import MiniProgramPage from 'E:/VsCodePro/UniAppStudy/project/pages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}